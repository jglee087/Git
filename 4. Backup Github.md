## 04 깃허브로 백업하기

### 04-1 원격 저장소와 깃허브

지금까지 컴퓨터에서 작업한 뒤 안에 커밋을 저장했다. 이 저장소를 **지역 저장소(local repository)**라고 한다. 

#### 원격 저장소란

깃에서는 지역 저장소와 **원격 저장소(remote repository)**를 연결해서 버전 관리하는 파일들을 쉽게 백업할 수 있다. 원격 저장소는 지역 저장소가 아닌 컴퓨터나 서버에 만든 저장소를 말한다.

원격 저장소는 지역 저장소와 연결되어 있으면서 '백업'과 '협업'이라는 중요한 역할을 한다.

원격 저장소를 직접 구축할 수도 있지만 만들고 유지하는 것이 쉽지 않다. 그래서 인터넷에서 원격 저장소를 제공하는 서비스를 주로 사용한다. 그 중에서 깃과 관련해 가장 많이 사용하는 서비스가 바로 **깃허브(github)**이다. 

#### 

#### 깃허브로 할 수 있는 일들

- **원격 저장소에서 깃을 사용할 수 있다**

  깃허브는 깃 사용을 위한 원격 저장소를 제공하는 서비스이기 때문에 따로 깃을 설치하지 않고도 온라인상에서 깃의 버전 관리 기능을 사용할 수 있다. 지역 저장소에서 깃을 사용하듯 인터넷에서 깃을 사용하는 것이다. 지역 저장소를 만들지 않아도 깃허브에 원격 저장소를 만들어 사용할 수도 있고, 지역 저장소가 있다면 원격 저장소와 연결해서 사용할 수 있다.

- **지역 저장소를 백업할 수 있다**

  깃허브에 원격 저장소를 만들고 사용자 컴퓨터의 지역 저장소를 연결한 후 동기화하면 지역 저장소를 인터넷상에 백업할 수 있다.

- **협업 프로젝트에 사용할 수 있다**
- **자신의 개발 이력을 남길 수 있다**

- **다른 사람의 소스를 살펴볼 수 있고, 오픈 소스에 참여할 수도 있다**

  

### 04-2 깃허브 시작하지

#### 깃허브에 가입하기

www.github.com에 접속하여 가입한다.

#### 깃허브에 원격 저장소 만들기



### 04-3 지역 저장소를 원격 저장소에 연결하기

#### 지역 저장소 만들기

1. local-git을 줄인 loc-git이라는 이름으로 새 디렉토리를 만들고 지역 저장소로 초기화하자. 그리고 디렉토리 안으로 들어가 문서 f1.txt를 만들고 영문자 'a'만 입력하고 파일을 저장한다.

   ```
   $ git init loc-git
   $ cd log-git
   $ vim f1.txt
   ```

   

2. f1.txt를 스테이지에 올린 후 커밋한다. 커밋 메시지는 'add a'라고 한다. git log 명령으로 커밋이 잘 되었는지 확인하자.

   ```
   $ git add f1.txt
   $ git commit -m 'add a'
   $ git log
   ```



#### 원격 저장소에 연결하기

1. 지역 저장소와 원격 저장소를 연결하려면 깃허브의 저장소 주소를 알고 복사해 온다.

2. 저장소 주소를 복사했다면 터미널 창에 다음과 같이 입력한다.

   ```
   $ git remote add origin 복사한 주소
   ```

3. 오류 메시지 없이 프롬프트($)가 나타나면 제대로 실행된 것이다.

4. 원격 저장소에 제대로 연결됐는지 확인하려면 git remote 명령에 -v 옵션을 붙여서 입력한다.

   ```
   $ git remote -v
   ```

5. 다음과 같이 remote에 origin이 연결되어 있고 origin이 가리키는 주소가 바로 옆에 표시될 것이다. 주소 끝에 있는 **fetch**와 **push**에 대해서는 앞으로 배울 것이므로 여기에서는 지역 저장소가 원격 저장소에 잘 연결되었는지 확인하자.



### 04-4 원격 저장소에 올리기 및 내려받기

지역 저장소와 연격 저장소를 연결했으니 이제부터 지역 저장소의 소스를 원격 저장소에 올릴 수도 있고, 원격 저장소에 있는 소스를 지역 저장소로 내려받을 수도 있다. 이때 지역 저장소의 소스를 원격 저장소로 올리는 것을 **푸시(push)**라고 하고, 원격 저장소에서 지역 저장소로 내려받는 것을 **풀(pull)**이라고 한다.



#### 원격 저장소에 파일 올리기 - git push

1. 지역 저장소의 브랜치를 origin, 즉 원격 저장소의 master 브랜치로 푸시하라는 명령이다. 여기에서 '-u' 옵션은 지역 저장소의 브랜치를 원격 저장소의 master 브랜치에 연결하기 위한 것으로 처음에 한 번만 사용하면 된다. 

   ```
   $ git push -u origin master
   ```

2. 터미널 창에서 푸시가 진행되는 것을 볼 수 있고 푸시가 끝나면 프롬프트($)가 나타난다.

3. 푸시가 끝났다는 것은 지역 저장소의 커밋이 원격 저장소로 올라갔다는 뜻이다.

4. 파일 목록 위의 '1 commit'을 눌러 보자. 지역 저장소에서 커밋했던 내용이 똑같이 올라와 있을 것이다.

5. 한 번이라도 지역 저장소와 원격 저장소를 연결해서 푸시했다면 그 다음부터는 더 간단하게 푸시할 수 있다. 지역 저장소에서 또 다른 커밋을 만들고 다시 푸시해 보겠다.

6. 원래 내용 다음에 영문자 'b'를 추가하고 저장 및 종료한다.

7. 다음 명령을 사용해 스테이징과 커밋을 한꺼번에 실행한다. 커밋 메시지는 'add b'라고 하겠다.

   ```
   $ git commit -am 'add b'
   ```

8. 지역 저장소에 새로운 커밋이 만들어졌으니 원격 저장소로 푸시하자. 이미 앞에서 지역 저장소와 브랜치와 origin의 master 브랜치를 연결했기 때문에 다시 파일을 푸시할 때는 git push라고만 입력하면 된다.

   ```
   $ git push
   ```

9. 깃허브 저장소 화면을 새로고침 하자. 파일 목록에서 파일 이름 오른쪽에 최신 커밋 메시지가 나타나는데, 방금 커밋한 'add b'라는 커밋 메시지가 보인다.

10. 가장 최근에 수정한 파일 내용인 a와 b가 들어있다.



#### 깃허브 사이트에서 직접 커밋하기

지역 저장소와 원격 저장소를 연결한 후 지역 저장소의 커밋을 원격 저장소에는 푸시하는 방법을 많이 사용하지만, 깃허브 사이트에서 직접 커밋할 수도 있다.

1. 깃허브의 저장소로 접속한다. 여기에 새로운 파일을 추가해 보자. [Create new file]을 누르자.
2. 맨 위에 파일 이름을 입력한 후 내용을 작성한다. 여기에서 파일 이름으로 f2.txt, 내용을 숫자 '1,2,3'을 입력하자.
3. 파일 내용을 입력했다면 화면 아래로 이동해 보자. 기본적인 커밋 메시지가 입력되어 있다. 이 메시지를 그냥 사용하거나 원하는 내용으로 수정한 후 [Commit new file]을 누른다.



#### 원격 저장소에서 파일 내려받기 - git pull

원격 저장소에 있는 소스 파일을 다른 사용자가 수정했거나 깃허브 사이트에서 직접 커밋하면 지역 저장소와 차이가 생긴다. 이럴 때는 원격 저장소와 지역 저장소의 상태를 같게 만들기 위해 원격 저장소의 소스를 지역 저장소로 가져온다. 이것을 **풀(pull)**이라고 한다.

1. 앞에서 git-loc 지역 저장소를 원격 저장소에 연결한 후 푸시했다. 그리고 깃허브 사이트에서 바로 f2.txt라는 파일을 새로 만들었다. 그러므로 loc-git 지역 저장소에는 아직 f2.txt라는 파일이 없다. 터미널 창에서 loc-git 디렉토리로 이동한 후 ls 명령을 사용해 디렉토리 안의 내용을 확인해 보면 지역 저장소에 만든 f1.txt 파일만 있다.

2. 다음 명령은 origin(원격 저장소)의 내용을 master 브랜치로 가져온다는 뜻이다.

   ```
   $ git pull origin master
   ```

3. 원격 저장소에서 소스 파일을 가져오는 과정이 화면에 나타나고, $가 화면에 표시되면 가져오기가 끝난 것이다.

4. git log 명령으로 커밋 로그를 확인해 볼까요? 깃허브 사이트에서 만들었던 'Create f2.txt'라는 커밋이 지역 저장소 커밋 로그에 나타나는 것을 확인할 수 있다.



#### 깃허브 저장소 화면 살펴보기

- **Fork**  이 저장소를 복제한다. 깃허브에서 오픈 소스 프로젝트에 참여하거나 직접 소스를 분석하면서 공부하려면 먼저 저장소를 복제해야 한다.



### 04-5 깃허브에 SSH 원격 접속하기

#### SSH 원격 접속이란

SSH는 Secure Shell의 줄임말로 보안이 강화된 안전한 방법으로 정보를 교환하는 방식이다. SSH에서는 기본적으로 프라이빗 키(Private Key)와 퍼블릭 키(Public Key)를 한 쌍으로 묶어서 컴퓨터를 인증한다. 퍼블릭 키는 말 그대로 외부로 공개되는 키이고, 프라이빗 키는 아무도 알 수 없게 사용자 컴퓨터에 저장되는 키이다.



#### SSH 키 생성하기

사용자 컴퓨터에서 SSH 키 생성기를 사용하면 프라이빗 키와 퍼블릭 키가 만들어 진다고 했다.

1. 터미널 창에서 홈 디렉토리로 이동한다. ssh-keygen이라고 입력한다. 화면에 SSH 키가 저장되는 디렉토리 경로가 표시되면서 파일 이름을 입력하라고 한다. SSH 키가 저장되는 디렉토리는 홈 디렉토리 안에 있는 .ssh 디렉토리임을 확인할 수 있다. 파일 이름은 입력하지 말고 `Enter`를 누른다.
2. 두 번 더 `Enter`를 누르면 화면에 SSH를 통해서 다른 컴퓨터에 접속할 수 있는 비밀번호가 생성된다. 실제로 내부를 들여다보면 굉장히 복잡한 비밀번호이기 때문에 외부에서 쉽게 공격할 수 없다. 화면에는 몇 가지 파일경로가 표시되는데 그 중에 id_rsa 파일이 프라이빗 키이고, id_rsa.pub 파일이 퍼블릭 키이다.
3. 이 키들이 .ssh 디렉토리에 저장되었는지 확인해 보자.  .ssh 디렉토리는 홈 디렉토리 하위에 만들어지므로 터미널 창에 다음과 같이 입력해서 .ssh 디렉토리로 한 번에 이동한 후 그 안의 내용을 살펴보자.
4. .ssh 디렉토리 안에 프라이빗 키 id_rsa 파일과 퍼블릭 키 id_rsa.pub 파일이 만들어진 것을 확인할 수 있다.



#### 깃허브에 퍼블릭 키 전송하기

1. SSH 키를 만들면 먼저 퍼블릭 키를 깃허브에 올려야 한다. 퍼블릭 키가 담겨 있는 id_rsa.pub 파일의 내용을 확인해 보자. 아직 .ssh 디렉토리에 있지 않다면 .ssh 디렉토리로 이동한 다음 cat 명령을 사용해서 파일을 열어 보자.

   ```
   $ cd ~/.ssh
   $ cat id_rsa.pub
   ```

2. 몇 줄에 걸친 문자열이 나타난다. 이것이 퍼블릭 키에 담긴 내용이다. 이 내용을 깃허브 서버에 올려야 한다.
3. Settings 중 SSH and GPG keys를 누른 후 퍼블릭 키를 추하기 위해 화면 오른쪽에 나타난 [New SSH key]를 누른다.
4. ssh-rsa아래에 입력한다.



#### SSH 주소로 원격 저장소 연결하기

1. 깃허브 사이트에서 화면 오른쪽 위에 있는 [+]를 누른 후 [New repository]를 선택한다. 저장소 이름을 입력한 후 [Create repository]를 눌러서 저장소를 만든다.

2. 저장소가 만들어지면 HTTPS 주소가 나타난다. 우리는 SSH 방식으로 접근할 것이므로 [SSH]를 눌러서 SSH 주소를 표시한다.

3. SSH 방식으로 접속해 보겠다.

   ```
   $ cd ~
   $ git init connect-ssh
   $ cd connect-ssh
   ```

4. SSH 주소를 사용해 원격 저장소에 연결하는 방법은 HTTPS 주소를 사용할 때와 같다. git remote add origin 명령 뒤에 복사한 주소를 붙인다.

   ```
   $ git remote add origin 복사한 주소
   ```

5. 오류 메시지 없이 프롬프트($)가 표시되면 정상적으로 연결



